{"version":3,"file":"index.js","names":["fs","require","path","Sequelize","process","basename","__filename","env","NODE_ENV","config","db","sequelize","DEV_DATABASE_URL","url","readdirSync","__dirname","filter","file","indexOf","slice","forEach","model","join","DataTypes","name","Object","keys","modelName","associate","module","exports"],"sources":["../../../src/database/models/index.js"],"sourcesContent":["\"use strict\";\r\n\r\nconst fs = require(\"fs\");\r\nconst path = require(\"path\");\r\nconst Sequelize = require(\"sequelize\");\r\nconst process = require(\"process\");\r\nconst basename = path.basename(__filename);\r\nconst env = process.env.NODE_ENV || \"development\";\r\nconst config = require('../../config/config.js')[env];\r\nconst db = {};\r\n\r\nlet sequelize;\r\nif (process.env.DEV_DATABASE_URL) {\r\n  sequelize = new Sequelize(process.env.DEV_DATABASE_URL, config);\r\n} else {\r\n  sequelize = new Sequelize(config.url, config);\r\n}\r\n\r\nfs.readdirSync(__dirname)\r\n  .filter((file) => {\r\n    return (\r\n      file.indexOf(\".\") !== 0 &&\r\n      file !== basename &&\r\n      file.slice(-3) === \".js\" &&\r\n      file.indexOf(\".test.js\") === -1\r\n    );\r\n  })\r\n  .forEach((file) => {\r\n    const model = require(path.join(__dirname, file))(\r\n      sequelize,\r\n      Sequelize.DataTypes\r\n    );\r\n    db[model.name] = model;\r\n  });\r\n\r\nObject.keys(db).forEach((modelName) => {\r\n  if (db[modelName].associate) {\r\n    db[modelName].associate(db);\r\n  }\r\n});\r\n\r\ndb.sequelize = sequelize;\r\ndb.Sequelize = Sequelize;\r\n\r\nmodule.exports = db;\r\n"],"mappings":"AAAA,YAAY;;AAEZ,IAAMA,EAAE,GAAGC,OAAO,CAAC,IAAI,CAAC;AACxB,IAAMC,IAAI,GAAGD,OAAO,CAAC,MAAM,CAAC;AAC5B,IAAME,SAAS,GAAGF,OAAO,CAAC,WAAW,CAAC;AACtC,IAAMG,OAAO,GAAGH,OAAO,CAAC,SAAS,CAAC;AAClC,IAAMI,QAAQ,GAAGH,IAAI,CAACG,QAAQ,CAACC,UAAU,CAAC;AAC1C,IAAMC,GAAG,GAAGH,OAAO,CAACG,GAAG,CAACC,QAAQ,IAAI,aAAa;AACjD,IAAMC,MAAM,GAAGR,OAAO,CAAC,wBAAwB,CAAC,CAACM,GAAG,CAAC;AACrD,IAAMG,EAAE,GAAG,CAAC,CAAC;AAEb,IAAIC,SAAS;AACb,IAAIP,OAAO,CAACG,GAAG,CAACK,gBAAgB,EAAE;EAChCD,SAAS,GAAG,IAAIR,SAAS,CAACC,OAAO,CAACG,GAAG,CAACK,gBAAgB,EAAEH,MAAM,CAAC;AACjE,CAAC,MAAM;EACLE,SAAS,GAAG,IAAIR,SAAS,CAACM,MAAM,CAACI,GAAG,EAAEJ,MAAM,CAAC;AAC/C;AAEAT,EAAE,CAACc,WAAW,CAACC,SAAS,CAAC,CACtBC,MAAM,CAAC,UAACC,IAAI,EAAK;EAChB,OACEA,IAAI,CAACC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,IACvBD,IAAI,KAAKZ,QAAQ,IACjBY,IAAI,CAACE,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,KAAK,IACxBF,IAAI,CAACC,OAAO,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;AAEnC,CAAC,CAAC,CACDE,OAAO,CAAC,UAACH,IAAI,EAAK;EACjB,IAAMI,KAAK,GAAGpB,OAAO,CAACC,IAAI,CAACoB,IAAI,CAACP,SAAS,EAAEE,IAAI,CAAC,CAAC,CAC/CN,SAAS,EACTR,SAAS,CAACoB,SAAS,CACpB;EACDb,EAAE,CAACW,KAAK,CAACG,IAAI,CAAC,GAAGH,KAAK;AACxB,CAAC,CAAC;AAEJI,MAAM,CAACC,IAAI,CAAChB,EAAE,CAAC,CAACU,OAAO,CAAC,UAACO,SAAS,EAAK;EACrC,IAAIjB,EAAE,CAACiB,SAAS,CAAC,CAACC,SAAS,EAAE;IAC3BlB,EAAE,CAACiB,SAAS,CAAC,CAACC,SAAS,CAAClB,EAAE,CAAC;EAC7B;AACF,CAAC,CAAC;AAEFA,EAAE,CAACC,SAAS,GAAGA,SAAS;AACxBD,EAAE,CAACP,SAAS,GAAGA,SAAS;AAExB0B,MAAM,CAACC,OAAO,GAAGpB,EAAE"}