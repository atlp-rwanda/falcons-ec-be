{"version":3,"file":"userController.js","names":["_index","_interopRequireDefault","require","_token_generator","_bcrypt","_user","_jwt","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty2","getOwnPropertyDescriptors","defineProperties","defineProperty","User","db","getAllUsers","_ref","_asyncToGenerator2","_regenerator","mark","_callee","req","res","allUsers","wrap","_callee$","_context","prev","next","findAll","sent","status","json","message","stop","_x","_x2","exports","loginUser","_ref2","_callee2","_req$body","email","password","user","payload","token","_callee2$","_context2","body","findOne","where","t0","checkPassword","id","generateToken","success","t1","send","error","_x3","_x4","registerUser","_ref3","_callee3","_yield$UserService$re","userData","userToken","_callee3$","_context3","BcryptUtility","hashPassword","UserService","register","JwtUtility","abrupt","_x5","_x6","_default"],"sources":["../../src/controllers/userController.js"],"sourcesContent":["// eslint-disable-next-line import/no-extraneous-dependencies\nimport db from '../database/models/index';\nimport generateToken from '../helpers/token_generator';\nimport { BcryptUtility } from '../utils/bcrypt.util';\nimport { UserService } from '../services/user.service';\nimport { JwtUtility } from '../utils/jwt.util';\n\nconst { User } = db;\n\nexport const getAllUsers = async (req, res) => {\n  const allUsers = await User.findAll();\n\n  if (!allUsers) res.status(400).json({ message: 'No users found' });\n\n  res.json(allUsers);\n};\n\nexport const loginUser = async (req, res) => {\n  try {\n    const { email, password } = req.body;\n    const user = await User.findOne({ where: { email } });\n\n    if (user && (await user.checkPassword(password))) {\n      const payload = {\n        id: user.id,\n        email,\n      };\n      const token = await generateToken(payload);\n      res.status(200).json({\n        status: 200,\n        success: true,\n        message: 'Login successful',\n        token,\n      });\n    } else {\n      res.status(401).json({\n        status: 401,\n        success: false,\n        message: 'Invalid credentials',\n      });\n    }\n  } catch (error) {\n    res.status(500).send({\n      status: 500,\n      success: false,\n      message: 'Failed to Login',\n      error: error.message,\n    });\n  }\n};\nexport const registerUser = async (req, res) => {\n  try {\n    const user = { ...req.body };\n    user.password = await BcryptUtility.hashPassword(req.body.password);\n    const { id, email } = await UserService.register(user);\n    const userData = { id, email };\n    const userToken = JwtUtility.generateToken(userData);\n    return res.status(201).json({ user: userData, token: userToken });\n  } catch (err) {\n    return res.status(500).json({\n      error: err.message,\n      message: 'Failed to register a new user',\n    });\n  }\n};\n\nexport default { getAllUsers, loginUser };\n"],"mappings":"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"}